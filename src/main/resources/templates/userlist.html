<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>회원 목록</title>
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
</head>
<body>
  <h2>회원 목록 (관리자 전용)</h2>
  <table border="1">
    <thead>
      <tr><th>아이디</th><th>이름</th><th>권한</th><th>관리</th></tr>
    </thead>
    <tbody id="userTable"></tbody>
  </table>

  <script>
    const token = localStorage.getItem("token");
    if (!token) {
      alert("접근 권한이 없습니다.");
      window.location.href = "/login";
    }

    $.ajax({
      url: "/api/v1/users?keyword=",
      type: "GET",
      headers: {
        "Authorization": "Bearer " + token
      },
      success: function(users) {
        users.forEach(user => {
          $("#userTable").append(`
            <tr>
              <td>${user.userId}</td>
              <td>${user.userNm}</td>
              <td>${user.userAuth}</td>
              <td><a href="/admin/userdetail?userIdx=${user.userIdx}">상세</a></td>
            </tr>
          `);
        });
      },
      error: function() {
        alert("접근 권한이 없습니다.");
        window.location.href = "/login";
      }
    });
  </script>
</body>
</html>
